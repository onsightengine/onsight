// https://github.com/emilwidlund/ASCII
// image to base64: https://www.base64-image.de/

import * as THREE from 'three';
import { System } from '../../System.js';

const TEXTURE_SIZE = 64;

const _sources = {};
_sources['brick'] = 'data:image/png;base64,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';
_sources['cross'] = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAMUElEQVR4nMWbvW8bRxrGn9ld0UTsSKSBIEJixA5SxIhjkw6UmFRgh9f5qmOZq0x310UpUkdXCtYqyl8guruS7nKVaUgUTYWR5UAIckUCBUiAGAH4IVL83J33Cu6sh8v9IqXcvcCCuzv7Mc9v3pl3dmbI4GI//fTTQrvdzhJRFkDMmc4YO2CMFW7cuPHE7f7/tR0eHiZM08wRUdIlucEYK1y4cKHwzjvvNJ2JTD6oVqsLqqrmAKzCEs7Y6BLxKxsRHSiKsnrjxo1HpxUxix0eHiYMw9hkjGXc0olI3m8AWDVNM7+0tGSDcAJ4xhizKTpFy8eMMfl4M5FIfD6zkhns+++//xsRFcQxETkFj10vjonoYGlp6aY4byvY29vbYozl5JuCADh+88lk8v6sgqax58+f3yOivCRq7Ne575KW/+ijj+4DFoBKpXIPQN75oikBAECRc56VXeys7dmzZ18R0QowKTwsAMtyt27desiq1erCYDA4Yoy5NXaexx4AwBhrMMYyH3zwwfOp1flYtVpdUBSlSETJMMKDABBRIxKJXFEGg0GOiGKcc4TdiMgvPcY5L+7v739yVuL39/cTRFTknCdDvD+shthgMMix7e3txwAybi/28gAvT3CmK4qSW1paenha8aZpFgHE5IYu6Ne573YMoMiKxWL9DN3f/pUbR9HgTGt7e3ufAdiUxZ0lACJqsMePH09gkcW4HU8JAACKqVTqL0GCZdvb29siopxT/FkB4JxDURSwra0tarVauHTpEhYWFk4NwGe/qGlaqAjx9OnTLQA5p+BpPMEPwMnJCVqtFjqdDrTDw8PG/Px8DAD6/T4uXrw4InNGABhjICIwxjKDwaBYrVYzXhCq1eqCYRgFIsq4CT4tANM00W630ev1UK/XUa/XoQEotlqtrHioYRi4ePEi5ubmzgyAdJzs9/tHlUolc+vWrbEwub+/f7nX6xUAJKcRHzYUGoaBdruN4XBoi282m0UNQAFAtt1ujz1gfn4e0WjUVbR4sFOsVdIT++I661xsOBwWZQilUulyt9s9gNXSO4WHKX0/AL1eD4PBAIPBAPV6HY1GA81mEwCKmqZpBcMwGoyxmBOCaZqIRqOuIU4WKX6dJe+EIHlRbDAYFLe3tzORSASGYRQhhbkg8WEbQiJCt9uFaZq2+Hq9juPjY5GeV0ulUn95ebnHGLsLAIPBAKZpAgBUVQUAu02Ytt65xF3bGGNRAJ9yznOzivfbDMNAt9sF59xVPIBVXdcfqQBQLpcr6XQ6yRi7CgDD4dCGoGnaROmfsvMhWxRAdBrxYbbhcIjBYABg1LAL8a1WS7y3qKrqSqlU6qvizJ07d77hnC+Kz2EnBEVRQET2rxcAL9EB3gAisrvZ07YDTvGGYfiJP1BV9e7a2loTAGwApVKpXy6XHy0vLwNW11hAICJomgZN02Ca5oQn+O2HNQFWhjCNNwhX55x7iieigqZpWSF+DICw3d3dJ+l0+ogxlpUhACNPmJubA+d8rKFzE30aCAL6NO3AcDi0nyPifKPRkMXndV3/e6lU6svvnAAAAOVy+fny8vIBEd1ljEW9IASJDgtB7mOoqgrO+RgEp1hnyQuXl8XX63VIUW1V13XXEStXAACwu7v7n3Q6/Q2ATwUE8SJVVRGJRMYyGCRYTnMbX5RN07QJCG6lb5qm7fJe4okop+v6117v8gQAAOVy+YUF4S5jLGYYxgQEp7hZXB+YhCIgGIbhKt7pgd1uF41GwxZPo0HQf+i67vs57gsAGEG4c+dOnojuAlj0g0BEY+3CLMLlc6KqDYfDCfGydbtdu+RPTk5ARA0iymxsbPw76P2BAIBRhLh9+/a/iCgF4IqAQESenuB27BQYdJ4xhkgkAtM0YRiGa7vjIv6IiO5ubGyEGpILBQAYQdjd3X2YTqevMMaSbp4gSn/aahD05Xnu3DkYhoHhcDiW1ul07Nb+5OQEAA40TUutr6//EvbdoQEIK5fLj4IgAOHagjCf3GI/Go3CNE07Ggnx9XodnU4HGHVwMnKMD2NTAwBsCEeMsaxcHRRFwblz5+zMO+uqU5jXOa9P72g0Cs45jo+Px8RbMf6vzhgfxmYCAIz6CjIE0RGRIQQ1iNMMuoj9ubk5vHjxAn/88YcsfuYJmZkBACMIqVSqAOBT0zSjbhAURZlovKZxfecvYwzxeBy//fYber1eTtf1f55Gg3+PJIRVq9WFX3/9tbizs5MEgEgkgng8jng8jvn5efs6wzAmxgbEZ7bzWD7vPCelNVRVzdy+fftUEzDKacV3u91iPB5PJhIJAPD69oamaXYMd05uyN3aoA8iyZtipmkWt7e3E/8XAEI8WVNVly5dwvXr1wMhAJgQ6QfBC4rVwMY45/nTQJgZQK/Xs8WL7c0338S1a9cCIcjf/36lHsYjiCjJOc9Xq9UFr7yeOYBSqbTlFC8y+cYbb+C9996zIdRqNdRqNTEICWDUZ5A7TUGl7eYpju+DZLfbLc4CYWoAlvicT4lgcXERV69ehaqqzmFoTwiztANOT+h0Opt/KoDd3d3PnOK9Mrq4uIhEIjEBodFouEIIKvWAaiA8Ibezs7P1pwB4+vTpZ0S06ZcBZybPnz+P999/34ZQq9VCQQgj1mfL7ezsfHWmACqVyj3Oua94r+38+fO4du0aVFWFYRieniCGw8J4VwhPWCmXy/fCaAvsCFUqlQTn/MBvgYR87LZPRGi1Wvjxxx9hmiY0TbM7S7HYy5l5ca2z4zPLvqIo0DQt6ZyCc5qvB1QqlQQRFR10nbQDS4RzjldeeQXvvvuu7QkiOtTr9ZeZkSZgvDxhGq8wDKNYqVR8+wieAKyQkici31mbabYLFy7grbfeAjCaqRXVwQ2CT8jzc33nccw0zYJfeHQFUK1WFzjnRXLE+qDS98ucooxe9dprr+Htt9+GoiiBEELW96DjK4ZhePYRXAHQaA2er/hpNiFeWCQSsRdjmKZpV4darWa/S9wzy/tc7kuappkPBeC77777koiy8sPcMhKCPIhezhoLk0duhXHOxzxBhjCr57mcy3777bdf+gKoVqv3OOerQcLDZMBtNEiIr9VqYqQ3R0Q5NwjifrfwGLLUJ/LKOV+tVqtj4dEGYK3ry08j3K9qeImv1+tiCC2v6/pDXdcfyhDk6CAgyOOM0wh2O885z8trGBVgtDweo5UiMz00CIAodYd4exhLhkBErp5wFnkTxjm3I4MCAMfHx5skhTvZpvUEp+vLYqwR5AO3MTxrBmdzWghhBLukxRhjmwCg/PDDD5cB5MKIDqBqD1m7ibfSDlRVzTjFC1tfX/+ciPJOCLVazX52mCoQlGal5/b39y8rw+FwJcTFQfVqbIbWTTwRNcKM2+u6fl+GIKqOBNHuaofJn186Ea1oRJSZRrDbNfLcvJv7kjVXF3bSQtO0FdM0r8BaqCF3kuLxOFRVtRdqOBZfuebfbS7C0pRRyKXD42ZeQILEW+czYefqAGBtba2pqmoWwIE4J6pCrVazvc1ZLfw0uF3DGEtOdITClL64Tl6S4hXHiSg3jXgHhAwRHYlzLqF0rACm1QAAStAFbg8ERuP8cp2US0gWHzQ/72dra2tNGvVK7cEDJwR5+nwWLQqAIy+RXiYvQ/PqxgLYPI14YRsbG88VRcnK52QIYvmOMwK5aXLRdaQQ0cHEnS43CzNNE/1+3953E09E+fX19TP7F9mDBw+ekNVREtZoNOwIIQrEuaQmhB0oiqIUgq97Ge56vR6Al+KdX3EAiqeZrPQyuaMkrNlsjnlCv98PJVwCVFBu3rz50ApTgTefnJzYHR6373iMOjpZr/tPa3JHSZiAUKvV0O/30e12w3aKGktLSw9FFMi5XSybWHfrJZ6IjmZZoDCtWd41Vm1lT+j1erYnBESxHGB9C3z44YePnGSti0BE9kO9xvIsD8r+2eKFOcMjgLFFE+12226kPSyfSqUeAdLncCqVus8YW3FeaRgGOp2O55A2RqWRnCXWz2oW6AwcniAg1Go1NBqNie65ZavpdNpuo8Y6QqlU6mvOeVJ+sOhsuIknooKqqhld10MvSjor03X9F8sTxhpx2RNEg23ltUFE2Y8//nhsQYXnvMCTJ0/ucc6znPPszz//jN9//x3NZhNWp6SgKEr+wYMHT85a2Cz2xRdffGL97yDLrL8Avv7667h+/To0TSuqqlp49dVX827/VfovoSzu2ZmJMHwAAAAASUVORK5CYII=';
_sources['none'] = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAAXNSR0IArs4c6QAAAKRlWElmTU0AKgAAAAgABgESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAZodpAAQAAAABAAAAegAAAAAAAABIAAAAAQAAAEgAAAABMjAyMDowMjoxMiAyMDoyMTozOQAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAABHc6clAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGtWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyI+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTI4PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjEyODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDx0aWZmOkltYWdlV2lkdGg+MTI4PC90aWZmOkltYWdlV2lkdGg+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkltYWdlTGVuZ3RoPjEyODwvdGlmZjpJbWFnZUxlbmd0aD4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZmZpbml0eSBEZXNpZ25lciAoU2VwIDIyIDIwMTkpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPnByb2R1Y2VkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjAtMDItMTJUMjA6MjE6MzktMDU6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMjAtMDItMTJUMjA6MjE6MzktMDU6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDIwLTAyLTEyVDIwOjIxOjM5LTA1OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8cGhvdG9zaG9wOklDQ1Byb2ZpbGU+c1JHQiBJRUM2MTk2Ni0yLjE8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KZCR8fQAAAANQTFRF////p8QbyAAAAAtJREFUCB1jGOQAAACgAAGXmq1SAAAAAElFTkSuQmCC';
_sources['stitch'] = 'data:image/png;base64,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';
_sources['tile'] = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAKRlWElmTU0AKgAAAAgABgESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAAEyAAIAAAAUAAAAZodpAAQAAAABAAAAegAAAAAAAABIAAAAAQAAAEgAAAABMjAyMDowMjoxMyAxNToxMjo0NAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAABsHpBwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGtWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyI+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MjU2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjI1NjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDx0aWZmOkltYWdlV2lkdGg+MjU2PC90aWZmOkltYWdlV2lkdGg+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkltYWdlTGVuZ3RoPjI1NjwvdGlmZjpJbWFnZUxlbmd0aD4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZmZpbml0eSBEZXNpZ25lciAoU2VwIDIyIDIwMTkpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPnByb2R1Y2VkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjAtMDItMTNUMTU6MTI6NDQtMDU6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMjAtMDItMTNUMTU6MTI6NDQtMDU6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDIwLTAyLTEzVDE1OjEyOjQ0LTA1OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8cGhvdG9zaG9wOklDQ1Byb2ZpbGU+c1JHQiBJRUM2MTk2Ni0yLjE8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KYfKgUAAAA2lJREFUWAl9l0FuKkEMRBsYiJQFm5yEo3Ik1lyELRIIQQR8nuGNKi34lhrb5XK5u4GQmazX6/t8Pm/X67VNJpN2v9+bRn673QonxrIu7xMu197kLxaLdrlc2kCwWq2aQJIzdoiYPkXBGJqeOjlrOp2W//7+br+/v22z2bSBgBv4+flpx+PxY7ODHICg4vj/nZbBs9msDcNQ+svlsu12u9rEQJGrOBwO7XQ61S5L+SWKsDt3UD9cPp6amzHHuwE2QXw+n4s7UMTyip7I89XhCvfDzbNHLT4/mDeAVw9fNV5ShDhP0NfJqdvjELx9xOLy8Zgc4/EGBBTvieYO5luDkTs8Ny+/SI8X+J4ezPqQTZIdgreut9E8OX0/OXWNXpY94HUDkvQUjG0Aw8wVkcfpHADPet9Dzo2NfRLxeZU24jHEseS/i91gkV8v8kip+wEkHxQmkShGjplX8noRY9MKEqfRD8+lHhyx53fhAVBEiOVNvBNLEWIWYvSooc9B48DX10/t8UMogQICGBhmjk+M2FoRX1w5eg8GB0yc3vEGvD6LKdgPoQbGki9HHW8xOXLVJh83oIDF9BAVFleMPnvF9OLpk49WfQgTtJliNpJjYsRwuV57skZdUx/PQTKf0izQx+b6XhC8r8lJjz48jA2nTbOYBWMbyfklQ4A/q+Apho7mpsTIE8u8bsBGBGli8ZOpieVgMXwK0gOmUcPQzusfcYl6myWDi8nx5IjAUyy5YCy58NwEPPHx1zBFMnZ4bojYYdYLeLzYm7iYv4hy8eMnwgbJ5pAcSEydZR3voi6eMRgnZhGnxrgBG9yAJHOajRWhRx6x5iZy49Z6fm1AQQdABlOI3FoKiFmH7ynBet3kW6sNWEhxh7/zDHFABTGM95mFpZ4zqvCqEY9vAYNcFPL6vH43Q52vKcvNgFFnUPLV7D18uH/+I1KE4YjYJE6DQ8Aw8tyEm/LEeDF4qUtv/RwTSOKvnc3gGHkOIadmHZ898q2jQT8zXNbGG6DAE5Ji+D42VxDfbyY3wlDfSvR9KAH3QPVr+PX11XhecyjCWObGnwYiCEfLGIw6G2Axa7/f1+Yf+VCPSTyr+em12aHmiuutm+Pl6hPz5ByYx0EeiAee0bbbbQ23Ka/RGCFjeWBp4N4QuLFeLm8Lm+DB+B/nadRPdzn3UQAAAABJRU5ErkJggg==';
_sources['woven'] = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABemlDQ1BJQ0MgUHJvZmlsZQAAKJF9kE0rRFEYx39miLxkwcKCunlbDTFqYqNmJg1loUF529y55kWZ63bvFbKxULZTlNh4W/AJ2Fgoa6UUKVn5BMRGup5jaLyUp855fuc55/n3nD/4ArplzRZ3QNZ07Xgsoo2NT2ilD/ioooxGGnTDscJDQ4NIfOWf8XJNkcpXbUrr7/2/UTGddAwoKhPuNSzbFe4XblpwLcVKr9aWoYRXFKfzvKE4keejjzcj8ajwqbBmZPRp4TvhgJGxs+BT+s2Jb2/S3zg7O298zqN+Upk0R4clN8qqxyFOjAgaA/QRJUQnPbKHaCNIu5xwk4uuao7OWUv2TDrjamFxIqkNmEZ7QAt2BMVf5etvvwq1uV3ofgZ/rlBLbMLJGtTdFmrNO1C9Csfnlm7rHyW/LF8qBY+HUDUONZdQPumkuoL5H1VGoOTe855aoHQd3nKe97rneW/70iwenZl5jz61OLiBkWUYvICtbWgV7eqpdwFMZxuNQsr2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAGU2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOkltYWdlV2lkdGg+MTI4PC90aWZmOkltYWdlV2lkdGg+CiAgICAgICAgIDx0aWZmOkltYWdlTGVuZ3RoPjEyODwvdGlmZjpJbWFnZUxlbmd0aD4KICAgICAgICAgPHBob3Rvc2hvcDpJQ0NQcm9maWxlPnNSR0IgSUVDNjE5NjYtMi4xPC9waG90b3Nob3A6SUNDUHJvZmlsZT4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjEyODwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTI4PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAyMC0wMi0xMlQyMDoyMTozOS0wNTowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMjAtMDItMTJUMjA6MjE6MzktMDU6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZmZpbml0eSBEZXNpZ25lciAoU2VwIDIyIDIwMTkpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPnByb2R1Y2VkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjAtMDItMTJUMjA6MjE6MzktMDU6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkL1WGcAAA59SURBVHgBjdvJinTVEobhVNO+70VssUUEQRDEiTgRcSxOvQhvyZFegQNB1KkTUUQExb4X+7459Sx968TZJ0v/gJURK7ovIvbKrKq9s0477bTT/tzv97tff/11d8stt+wee+yx3XXXXbc7//zzd+eee+7urLPOWuv000/ftY5ilrwb9Oeff67dH3/8sSPj1m+//bb75Zdfdj///PPu+++/333xxRe7F154Yffss8+uvOzw+TzyyCO7+++/f3f55Zcv7HPOOWf5sFsTXw1R2OH+/vvvCzfsn376affDDz/sPv/8892LL764e/755/+LPRNddtllq/Gzzz57Z2n+zDPPXMAKqPFZiCK2BWi8vGecccbKw0dhBnv11Vev2svJxwDefffd3a233ro777zzVrwcNSUnP9jVMQfALww4lpwN/8cff9x98sknu7feemuF1cNeYpN2Aq644ordhRdeuArWvAKBNn2yVQE1KWMFVLACUD4GSedUXXrppcvmqkx6//331xAuuOCC4zj1iasWhasBlXti83XlLT0ZwHfffbeu/ttvv73yi3Uq0P6OO+7YvfHGG2uj6Y59gPGaP9UBVJyCKtAQDNuQH3rood2VV165u+SSS3YaZrv44otXc+z8YHcC4c6rX/5yGxS5K8tu2SP8vvvu2915553r7fDpp5/uPvroo93+4Ycf3t19993raADu6AO3BCZXBF0AK/vRS4XgiqlA9nQ1pNEHH3xwNey4a1ajVpgNvAZqZuKSazz89rhT4AK0rr322p23Quvrr7/e7W+++eb1oeNqXHTRRccTBzybV9i/DUCzgK0GgM/i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';

export const PixelShader = {
	uniforms: {
        'resolution': { value: new THREE.Vector2() },
		'tDiffuse': { value: null },
        'tPixel': { value: null },
        'uCellSize': { value: 16 },
	},

	vertexShader: /* glsl */`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
		}`,

	fragmentShader: /* glsl */`
		#include <common>
		uniform vec2 resolution;
        uniform sampler2D tDiffuse;
        uniform sampler2D tPixel;
        uniform float uCellSize;

        varying vec2 vUv;

        void main() {
            vec2 cell = resolution / uCellSize;
            vec2 grid = 1.0 / cell;
            vec2 pixelUV = grid * (0.5 + floor(vUv / grid));
            vec4 pixelized = texture2D(tDiffuse, pixelUV);

            vec4 pattern = texture2D(tPixel, vUv * cell);
			float l = luminance(pattern.rgb);

            gl_FragColor = vec4(l * pixelized.rgb, pattern.a);
        }`,

    createStyleTexture: function(style) {
            const canvas = document.createElement('canvas');
            canvas.width = TEXTURE_SIZE;
            canvas.height = TEXTURE_SIZE;

            // // DEBUG
            // canvas.style['background'] = '#ff0000';
            // canvas.style['position'] = 'absolute';
            // canvas.style['z-index'] = 2000;
            // document.body.appendChild(canvas);

            const texture = new THREE.CanvasTexture(
                canvas, undefined,
                THREE.RepeatWrapping,
                THREE.RepeatWrapping,
                THREE.NearestFilter,
                THREE.NearestFilter,
            );

            const ctx = canvas.getContext('2d');

            if (!_sources[style]) {
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, TEXTURE_SIZE, TEXTURE_SIZE);
                texture.needsUpdate = true;

            } else {
                const image = document.createElement('img');
                image.src = _sources[style];
                image.onload = () => {
                    ctx.clearRect(0, 0, TEXTURE_SIZE, TEXTURE_SIZE);
                    ctx.drawImage(image, 0, 0, TEXTURE_SIZE, TEXTURE_SIZE);
                    texture.needsUpdate = true;
                };
            }

            return texture;
        }

};
